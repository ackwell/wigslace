{% extends 'layout.html' %}

{% block headJS %}
{% parent %}
<script src="/js/edit-plugins.js"></script>
<script src="/js/edit.js"></script>
{% endblock %}

{% block pageHeader %}Edit Profile{% endblock %}
{% block pageSubHeader %}{{ user.id }}{% endblock %}

{% block content %}
	<form action="{{ pageURL }}" method="post" enctype="multipart/form-data" class="form-horizontal">
		<fieldset>
			<div class="clear">
				<div class="half">
					<a href="#password-modal" role="button" class="button full-width" data-toggle="modal">Change password</a>
				</div>
				<div class="half">
					<div class="fileupload fileupload-new" data-provides="fileupload">
						<div class="fileupload-new thumbnail" style="width: 200px; height: 200px;">
							{% if user.avatar %}
								<img src="{{ user.avatar }}200.png"/>
							{% endif %}
						</div>
						<div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 200px; line-height: 20px;"></div>
						<div>
							<span class="button file">
								<span class="fileupload-new">Change Avatar</span>
								<span class="fileupload-exists">Edit</span>
								<input type="file" name="avatar"/>
							</span>
							<a href="#" class="button fileupload-exists" data-dismiss="fileupload">Cancel</a>
						</div>
					</div>
				</div>
			</div>
			<button type="submit" class="button primary">Save Changes</button>
		</fieldset>
	</form>

	{# Change password modal #}
	<div id="password-modal" class="modal hide fade" tabindex="-1" role="dialog">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h3>Change Password</h3>
		</div>
		<form action="{{ siteURL }}/change-password" method="post" class="form-horizontal" style="margin: 0;">
			<div class="modal-body">
				<div class="control-group">
					<label class="control-label" for="password_original">Old Password</label>
					<div class="controls">
						<input type="password" name="password_original" id="password_original"/>
					</div>
				</div>
				<div class="control-group">
				<label class="control-label" for="password">New Password</label>
					<div class="controls">
						<input type="password" name="password" id="password"/>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="password_confirm">Confirm New Password</label>
					<div class="controls">
						<input type="password" name="password_confirm" id="password_confirm"/>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-primary" data-loading-text="Saving...">Save</button>
			</div>
		</form>
	</div>
{% endblock %}